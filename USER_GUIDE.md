# ILAL 用户指南

## 目录

1. [什么是 ILAL?](#什么是-ilal)
2. [为什么需要验证?](#为什么需要验证)
3. [如何开始使用?](#如何开始使用)
4. [常见问题 FAQ](#常见问题-faq)
5. [故障排查](#故障排查)

---

## 什么是 ILAL?

**ILAL (Institutional Liquidity Access Layer)** 是一个基于 Uniswap v4 的合规流动性协议，专为机构投资者设计。

### 核心特性

- ✅ **合规性**: 只有通过 KYC 验证的用户才能交易
- 🔒 **隐私保护**: 使用零知识证明技术，您的身份信息不会在链上公开
- 🚀 **高性能**: 基于 Base L2，Gas 费用极低
- 🔄 **去中心化**: 无中心化托管，您始终控制自己的资产

### 适用人群

- 机构投资者
- 合规要求严格的基金
- 需要隐私保护的高净值个人

---

## 为什么需要验证?

### 监管合规

ILAL 旨在为机构投资者提供合规的 DeFi 访问通道。根据不同司法管辖区的要求，金融服务提供者必须验证用户身份（KYC/AML）。

### 零知识证明

传统 KYC 会在链上暴露您的个人信息。ILAL 使用**零知识证明（ZK Proof）**技术：

- ✅ 向链上证明"我已通过 KYC"
- ❌ **不会**暴露您的姓名、地址等敏感信息
- 🔒 完全隐私保护

### 验证提供者

目前支持的 Issuer（身份验证提供者）：

| Issuer | 描述 | 验证方式 |
|--------|------|---------|
| **Coinbase** | Coinbase Verifications | 通过 EAS 链上认证 |

未来将支持更多 Issuer（Circle, Polygon ID 等）。

---

## 如何开始使用?

### 步骤 1: 准备钱包

1. 安装 [MetaMask](https://metamask.io/) 或 [Rainbow Wallet](https://rainbow.me/)
2. 添加 **Base Mainnet** 网络:
   - 网络名称: `Base Mainnet`
   - RPC URL: `https://mainnet.base.org`
   - Chain ID: `8453`
   - 符号: `ETH`
   - 区块浏览器: `https://basescan.org`

### 步骤 2: 完成 Coinbase 验证

1. 访问 [Coinbase Verifications](https://www.coinbase.com/onchain-verify)
2. 使用您的 Coinbase 账户登录
3. 完成身份验证流程
4. 将认证发布到链上（免费）

**注意**: 这是**链上公开认证**，但不包含您的个人信息。

### 步骤 3: 访问 ILAL DApp

1. 打开 [app.ilal.xyz](https://app.ilal.xyz) (示例 URL)
2. 点击 **连接钱包**
3. 选择您的钱包并授权连接

### 步骤 4: 验证身份

1. 点击 **开始验证**
2. DApp 会自动检测您的 Coinbase 验证状态
3. 在浏览器中生成零知识证明（需要 5-30 秒）
   - ⏳ 请耐心等待，这是一次性操作
   - 💻 计算在本地进行，您的数据不会被上传
4. 提交证明到链上（需要支付 Gas 费用）
5. ✅ 验证成功！您的会话将在 **24 小时**内有效

### 步骤 5: 开始交易

1. 进入 **交易界面**
2. 选择交易对（例如 ETH/USDC）
3. 输入交易金额
4. 点击 **交易**
5. 在钱包中确认交易
6. ✅ 交易完成！

---

## 会话管理

### 会话 (Session) 是什么?

为了避免每次交易都生成 ZK 证明（耗时且昂贵），ILAL 使用 **Session 机制**：

- 验证一次，24 小时内有效
- 过期后需要重新验证
- 您可以随时手动结束 Session

### 如何检查会话状态?

在 DApp 右上角会显示：

- ✅ **已验证**: 绿色指示灯，显示剩余时间
- ❌ **未验证**: 红色指示灯，需要重新验证

### 如何续期会话?

会话过期后：

1. 返回首页
2. 点击 **开始验证**
3. 重新生成 ZK 证明并提交

---

## 常见问题 FAQ

### Q: 为什么交易被拒绝?

**可能原因**:

1. **Session 已过期**: 请重新验证
2. **未完成 Coinbase 验证**: 请先完成链上认证
3. **Gas 费用不足**: 确保钱包有足够的 ETH
4. **系统紧急暂停**: 等待治理解除暂停

### Q: 零知识证明生成需要多久?

- **首次**: 5-30 秒（需要下载电路文件）
- **后续**: 10-20 秒（文件已缓存）

**优化建议**:
- 使用现代浏览器（Chrome, Brave）
- 确保良好的网络连接

### Q: 我的个人信息会被公开吗?

**不会。** ILAL 使用零知识证明技术：

- ✅ 链上只能看到: "地址 0x... 已通过验证"
- ❌ 无法看到: 您的姓名、地址、KYC 详情

### Q: 可以转让 LP NFT 吗?

**不可以。** 为了确保合规性，ILAL 的流动性头寸（LP NFT）**禁止转让**：

- ✅ 您可以添加/移除流动性
- ❌ 您无法在 OpenSea 等市场交易 LP NFT
- ⚠️ 只能通过 ILAL DApp 管理头寸

**原因**: 防止未验证用户通过购买 NFT 获得流动性仓位。

### Q: Gas 费用是多少?

| 操作 | Gas 消耗 | 预估费用 (Base) |
|------|---------|----------------|
| 验证身份 | ~350k | $0.50 - $2.00 |
| Swap 交易 | ~200k | $0.30 - $1.00 |
| 添加流动性 | ~250k | $0.40 - $1.50 |

**注意**: Base 的 Gas 费用远低于以太坊主网。

### Q: 支持哪些代币?

目前支持 Base 主网上的主流代币：

- ETH (原生)
- USDC
- WBTC
- DAI

更多代币将逐步添加。

### Q: 如果忘记结束 Session 会怎样?

- Session 会在 24 小时后自动过期
- 过期后需要重新验证
- 不会对您的资产产生任何影响

### Q: 可以在多个设备上使用吗?

可以！只要：

1. 使用同一个钱包地址
2. 该地址的 Session 仍然有效

您可以在不同设备上访问 ILAL DApp。

---

## 故障排查

### 问题 1: 验证失败

**检查清单**:

- [ ] 已完成 Coinbase 链上认证?
- [ ] 钱包连接到 Base Mainnet?
- [ ] 钱包有足够的 ETH 支付 Gas?
- [ ] 浏览器允许运行 Web Workers?

**解决方案**:
```
1. 刷新页面
2. 断开并重新连接钱包
3. 清除浏览器缓存
4. 尝试其他浏览器
```

### 问题 2: ZK 证明生成卡住

**原因**: 浏览器性能不足或网络问题

**解决方案**:
- 关闭其他标签页释放内存
- 确保网络连接稳定
- 使用性能更好的设备

### 问题 3: 交易一直pending

**可能原因**:

1. **Gas 价格设置过低**: 在钱包中提高 Gas 价格
2. **网络拥堵**: 等待或取消交易
3. **Nonce 错误**: 在 MetaMask 设置中重置账户

### 问题 4: Session 显示不正确

**解决方案**:
```
1. 点击 "刷新状态" 按钮
2. 刷新页面
3. 重新连接钱包
```

---

## 获取帮助

### 社区支持

- **Discord**: [discord.gg/ilal](https://discord.gg/ilal)
- **Telegram**: [@ilal_support](https://t.me/ilal_support)
- **Twitter**: [@ILAL_Protocol](https://twitter.com/ILAL_Protocol)

### 技术文档

- [架构文档](./ARCHITECTURE.md)
- [开发者文档](./README.md)
- [智能合约代码](./contracts/)

### 报告问题

如果遇到 bug 或安全问题:

- GitHub Issues: [github.com/ilal/ilal/issues](https://github.com/ilal/ilal/issues)
- 安全邮件: security@ilal.xyz

---

## 法律声明

- ILAL 是一个技术协议，不提供投资建议
- 使用 ILAL 需自行承担风险
- 请遵守您所在司法管辖区的法律法规
- 智能合约代码已开源并经过审计，但仍可能存在风险

---

**最后更新**: 2026-02-10  
**版本**: 0.1.0 Beta
