# ILAL 功能测试清单

**测试日期**: ___________  
**测试人员**: ___________  
**测试环境**: Base Sepolia (84532)

---

## ✅ 测试清单

### 📱 Web Demo 测试

#### 1. 钱包连接
- [ ] 打开 http://localhost:3000
- [ ] 点击 "Connect Wallet"
- [ ] 选择 MetaMask 并连接
- [ ] 验证地址显示正确
- [ ] 验证网络显示为 Base Sepolia
- [ ] 验证余额显示正确
- [ ] 尝试断开连接
- [ ] 尝试重新连接

**问题记录**: ___________________________________________

#### 2. EAS 认证状态
- [ ] 系统自动检查 EAS 认证
- [ ] 显示认证状态（图标 + 文字）
- [ ] 点击查看认证详情
- [ ] 对于未认证用户，显示获取认证的指引链接
- [ ] 链接正确跳转到 Coinbase Verification

**问题记录**: ___________________________________________

#### 3. ZK Proof 生成
- [ ] 点击 "Generate Proof" 按钮
- [ ] 显示加载进度条
- [ ] 显示当前步骤提示（如 "Loading Poseidon hash..."）
- [ ] 生成时间在 15-30 秒内
- [ ] 完成后显示证明哈希（0x...）
- [ ] 可选：下载证明文件
- [ ] 尝试取消生成（如果支持）
- [ ] 尝试重新生成

**生成耗时**: ______ 秒  
**问题记录**: ___________________________________________

#### 4. Session 激活
- [ ] 点击 "Activate Session" 按钮
- [ ] MetaMask 弹出交易确认窗口
- [ ] 交易参数正确显示（合约地址、Gas 费）
- [ ] 签名并提交交易
- [ ] 显示交易pending状态
- [ ] 交易确认后显示成功提示
- [ ] 显示 Session 有效期（24 小时）
- [ ] 显示剩余时间倒计时

**交易哈希**: ___________________________________________  
**问题记录**: ___________________________________________

#### 5. Swap 操作
- [ ] 访问 Trade 页面
- [ ] 选择 Token In（如 ETH）
- [ ] 选择 Token Out（如 USDC）
- [ ] 输入金额（0.01 ETH）
- [ ] 自动显示预估输出
- [ ] 显示价格影响
- [ ] 显示滑点设置（默认 0.5%）
- [ ] 调整滑点设置（试 1%, 5%）
- [ ] 点击 "Swap" 按钮
- [ ] 确认交易详情弹窗
- [ ] MetaMask 弹出确认
- [ ] 签名并提交
- [ ] 显示交易状态
- [ ] 交易成功后显示详情
- [ ] 余额正确更新

**交易哈希**: ___________________________________________  
**问题记录**: ___________________________________________

#### 6. 添加流动性
- [ ] 访问 Liquidity 页面
- [ ] 点击 "Add Liquidity"
- [ ] 选择池子（ETH/USDC）
- [ ] 输入 Token A 数量
- [ ] 自动计算 Token B 数量
- [ ] 设置价格范围（Tick Lower/Upper）
- [ ] 批准 Token A（如需要）
- [ ] 批准 Token B（如需要）
- [ ] 点击 "Add Liquidity"
- [ ] 签名并提交交易
- [ ] 交易成功后显示 LP Token ID
- [ ] 在持仓列表中看到新持仓

**LP Token ID**: ___________________________________________  
**问题记录**: ___________________________________________

#### 7. 移除流动性
- [ ] 在持仓列表中选择一个持仓
- [ ] 点击 "Remove"
- [ ] 选择移除比例（100%）
- [ ] 显示预估收回的代币数量
- [ ] 点击 "Remove Liquidity"
- [ ] 签名并提交交易
- [ ] 交易成功后持仓列表更新
- [ ] 余额正确增加

**交易哈希**: ___________________________________________  
**问题记录**: ___________________________________________

#### 8. 交易历史
- [ ] 访问 History 页面
- [ ] 显示所有历史交易
- [ ] 每条记录包含：类型、金额、时间、状态
- [ ] 点击某条记录查看详情
- [ ] 详情显示完整信息（交易哈希、区块号等）
- [ ] 可以跳转到 BaseScan 查看
- [ ] 尝试筛选（按类型、按时间）
- [ ] 尝试搜索（按交易哈希）

**问题记录**: ___________________________________________

---

### 🔧 API 服务测试

#### 9. API 健康检查
```bash
curl http://localhost:3001/api/v1/health
```
- [ ] 返回 200 状态码
- [ ] 响应包含 `{"status": "ok"}`
- [ ] 响应时间 < 100ms

**问题记录**: ___________________________________________

#### 10. 用户注册
```bash
curl -X POST http://localhost:3001/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "SecurePass123!"
  }'
```
- [ ] 返回 201 状态码
- [ ] 响应包含 JWT token
- [ ] 响应包含 user id
- [ ] 尝试重复注册（应该失败）
- [ ] 尝试无效邮箱（应该失败）
- [ ] 尝试弱密码（应该失败）

**问题记录**: ___________________________________________

#### 11. 用户登录
```bash
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "SecurePass123!"
  }'
```
- [ ] 返回 200 状态码
- [ ] 响应包含 JWT token
- [ ] 尝试错误密码（应该失败）
- [ ] 尝试不存在的用户（应该失败）

**JWT Token**: ___________________________________________  
**问题记录**: ___________________________________________

#### 12. 创建 API Key
```bash
curl -X POST http://localhost:3001/api/keys \
  -H "Authorization: Bearer <JWT_TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "My Test Key",
    "description": "For testing"
  }'
```
- [ ] 返回 201 状态码
- [ ] 响应包含 API Key (ilal_test_xxx)
- [ ] API Key 格式正确
- [ ] 尝试不带 JWT（应该失败 401）

**API Key**: ___________________________________________  
**问题记录**: ___________________________________________

#### 13. ZK Proof 验证（通过 API）
```bash
curl -X POST http://localhost:3001/api/v1/verify \
  -H "X-API-Key: <API_KEY>" \
  -H "Content-Type: application/json" \
  -d '{
    "userAddress": "0x...",
    "proof": "0x...",
    "publicInputs": ["123", "456"]
  }'
```
- [ ] 返回 200 状态码
- [ ] 响应包含 txHash
- [ ] 响应包含 sessionExpiry
- [ ] 尝试无效的 proof（应该失败）
- [ ] 尝试无效的 API Key（应该失败 401）
- [ ] 检查限流（连续请求 20 次）

**问题记录**: ___________________________________________

#### 14. Session 状态查询
```bash
curl http://localhost:3001/api/v1/session/0x... \
  -H "X-API-Key: <API_KEY>"
```
- [ ] 返回 200 状态码
- [ ] 响应包含 isActive
- [ ] 响应包含 remainingSeconds
- [ ] 对于未激活的用户，返回 false

**问题记录**: ___________________________________________

---

### 📦 SDK 测试

#### 15. SDK 安装和导入
```bash
cd test-app
npm install @ilal/sdk
```
```typescript
import { ILALClient } from '@ilal/sdk';
```
- [ ] 安装成功，无错误
- [ ] 导入成功，无类型错误
- [ ] TypeScript 类型提示正常

**问题记录**: ___________________________________________

#### 16. 直接模式使用
```typescript
const client = new ILALClient({
  walletClient,
  publicClient,
  chainId: 84532,
});

// 检查 Session
const info = await client.session.getInfo();
console.log('Session active:', info.isActive);
```
- [ ] 客户端创建成功
- [ ] Session 查询返回正确结果
- [ ] 无运行时错误

**问题记录**: ___________________________________________

#### 17. API 模式使用
```typescript
import { ILALApiClient } from '@ilal/sdk';

const apiClient = new ILALApiClient({
  apiKey: 'ilal_test_xxx',
  apiBaseUrl: 'http://localhost:3001',
  chainId: 84532,
});

// 健康检查
const health = await apiClient.healthCheck();
console.log(health);
```
- [ ] API 客户端创建成功
- [ ] 健康检查返回 OK
- [ ] 无运行时错误

**问题记录**: ___________________________________________

---

### 🚨 异常和边界测试

#### 18. 网络异常处理
- [ ] 断开网络后尝试交易（显示网络错误）
- [ ] RPC 超时处理（显示超时提示）
- [ ] 切换到错误网络（提示切换回 Base Sepolia）
- [ ] Gas 不足时的提示
- [ ] 交易被拒绝时的处理

**问题记录**: ___________________________________________

#### 19. 输入验证
- [ ] 输入负数金额（应该阻止）
- [ ] 输入超过余额的金额（显示错误）
- [ ] 输入无效地址（显示错误）
- [ ] 滑点设置超过 50%（显示警告）
- [ ] 输入特殊字符（应该过滤）

**问题记录**: ___________________________________________

#### 20. 权限和合规
- [ ] 未激活 Session 时尝试 Swap（应该阻止）
- [ ] Session 过期后尝试交易（提示重新激活）
- [ ] 未完成 KYC 尝试激活 Session（提示完成 KYC）
- [ ] 在紧急暂停状态下尝试交易（显示暂停提示）

**问题记录**: ___________________________________________

---

## 📊 测试总结

### 测试统计
- **总测试项**: 20
- **通过**: ______
- **失败**: ______
- **跳过**: ______
- **通过率**: ______%

### 发现的问题

#### 严重 (P0) - 阻塞性问题
1. ___________________________________________
2. ___________________________________________

#### 重要 (P1) - 影响核心功能
1. ___________________________________________
2. ___________________________________________

#### 一般 (P2) - 体验问题
1. ___________________________________________
2. ___________________________________________

#### 轻微 (P3) - 优化建议
1. ___________________________________________
2. ___________________________________________

### 性能数据
- **页面加载时间**: ______ 秒
- **Proof 生成时间**: ______ 秒
- **交易确认时间**: ______ 秒
- **API 响应时间**: ______ 毫秒

### 用户体验评分
- **易用性**: _____ / 5
- **响应速度**: _____ / 5
- **错误处理**: _____ / 5
- **视觉设计**: _____ / 5
- **总体评分**: _____ / 5

### 改进建议
1. ___________________________________________
2. ___________________________________________
3. ___________________________________________

---

**测试完成日期**: ___________  
**下次测试计划**: ___________  
**签名**: ___________
