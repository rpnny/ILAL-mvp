# ILAL 前端UI测试手册

**日期**: 2026-02-11  
**前端URL**: http://localhost:3002  
**测试目标**: 验证新Pool配置和价格查询功能

---

## ✅ 自动化验证已完成

### 基础设施状态

| 项目 | 状态 | 详情 |
|------|------|------|
| **前端服务器** | ✅ 运行中 | http://localhost:3002 |
| **RPC连接** | ✅ 正常 | Base Sepolia, Block #37524249+ |
| **Pool配置** | ✅ 已更新 | fee=10000, tickSpacing=200 |
| **合约部署** | ✅ 完成 | 所有合约正常 |
| **Foundry测试** | ✅ 通过 | 120/120测试通过 |

---

## 📱 手动UI测试清单

### 阶段 1: 首页和连接 (5分钟)

#### 1.1 打开应用

```
✓ 在浏览器中打开: http://localhost:3002
✓ 页面正常加载，无白屏/错误
✓ 主导航栏显示正常
```

**预期结果**:
- 看到ILAL主页
- 导航菜单正常显示
- 无控制台错误

#### 1.2 钱包连接

```
✓ 点击"Connect Wallet"按钮
✓ 选择MetaMask或其他钱包
✓ 确认网络为Base Sepolia (Chain ID: 84532)
✓ 钱包地址显示在右上角
```

**注意**: 
- 如果网络不对，应提示切换到Base Sepolia
- 确保钱包有测试ETH和USDC

---

### 阶段 2: Pool列表验证 (5分钟)

#### 2.1 检查Pool显示

访问Pool列表页面，验证：

```
✓ 看到Pool列表表格
✓ 至少显示1个活跃Pool
✓ Pool显示以下信息：
  - 币对: WETH/USDC
  - Fee: 1% (或10000 bps)
  - TVL: ~$9
  - 流动性指示
```

**预期Pool配置**:
```json
{
  "token0": "WETH",
  "token1": "USDC", 
  "fee": 10000,      // 1%
  "tickSpacing": 200,
  "tvl": "~$9",
  "verified": true
}
```

#### 2.2 检查旧Pool

```
✓ 旧Pool (fee=500, 0.05%) 应显示为已废弃
✓ TVL显示为$0或标记为"无流动性"
✓ verified状态为false
```

---

### 阶段 3: 价格查询验证 (5分钟)

#### 3.1 实时价格显示

在Swap页面或Pool详情页：

```
✓ 价格数据正常加载
✓ ETH/USD价格显示在合理范围 ($2000-$5000)
✓ 价格实时更新（每30秒刷新）
✓ 无"Loading..."永久卡住
```

**如何验证**:
1. 打开浏览器开发者工具 (F12)
2. 查看Network标签
3. 确认有RPC调用到Base Sepolia
4. 响应状态为200，无错误

#### 3.2 Pool详情查询

点击活跃Pool进入详情页：

```
✓ Current Tick显示: ~196200
✓ sqrtPriceX96有值（不为0）
✓ 流动性显示: 2e12或2000000000000
✓ 图表/可视化正常渲染
```

---

### 阶段 4: Swap UI测试 (10分钟)

#### 4.1 Swap界面

访问Swap页面：

```
✓ "From"和"To"选择框正常显示
✓ 可选择USDC和WETH
✓ 输入金额后显示预估输出
✓ 显示交易费用: 1%
```

#### 4.2 价格计算

测试输入：

```
输入 1 USDC:
✓ 预估输出: ~0.00033 WETH (根据当前价格)
✓ 价格影响: <0.5%
✓ 最小接收显示
```

#### 4.3 Swap执行准备

**注意**: 实际Swap可能因TypeScript兼容性问题暂时无法执行，但UI应正常显示

```
✓ 点击"Swap"按钮
✓ 弹出确认对话框
✓ 显示交易详情：
  - 输入金额
  - 输出金额
  - Fee
  - Price Impact
```

**如果Swap失败**:
- ✓ 错误信息清晰显示
- ✓ UI不卡死
- ✓ 可以重试

---

### 阶段 5: 流动性页面 (可选，5分钟)

#### 5.1 查看流动性池

```
✓ 显示当前Pool的流动性分布
✓ Tick范围可视化
✓ TVL正确计算
```

#### 5.2 添加流动性UI

```
✓ "Add Liquidity"按钮可见
✓ 输入框显示USDC和WETH
✓ 显示Position范围选择
```

---

## 🐛 常见问题排查

### 问题1: 价格显示为0或N/A

**可能原因**:
- RPC连接失败
- PoolManager查询超时
- Pool未正确配置

**排查步骤**:
1. 打开浏览器控制台
2. 查看是否有RPC错误
3. 检查Network标签的请求状态
4. 验证合约地址是否正确

**解决方案**:
```typescript
// 检查 frontend/lib/contracts.ts
simpleSwapRouter: '0x96ad5eAE7e5797e628F9d3FD21995dB19aE17d58' // 应为新地址
```

### 问题2: Pool列表为空

**可能原因**:
- MOCK_POOLS配置错误
- hooks文件未更新

**解决方案**:
```typescript
// 检查 frontend/hooks/useLiquidity.ts
fee: 10000,        // ✅ 应为10000，不是500
tickSpacing: 200,  // ✅ 应为200，不是10
```

### 问题3: 前端服务器无法访问

**解决方案**:
```bash
cd /Users/ronny/Desktop/ilal/frontend
npm run dev

# 检查输出，确认端口
# 可能使用3002而不是3000
```

---

## 📊 测试数据记录

### 测试执行记录表

| 测试项 | 状态 | 备注 | 执行人 | 时间 |
|--------|------|------|--------|------|
| 前端服务器启动 | ⬜ | | | |
| 钱包连接 | ⬜ | | | |
| Pool列表显示 | ⬜ | | | |
| 价格查询 | ⬜ | | | |
| Swap UI | ⬜ | | | |
| 流动性页面 | ⬜ | | | |

**说明**: 
- ✅ = 通过
- ❌ = 失败  
- ⚠️ = 部分通过/有警告
- ⬜ = 待测试

---

## 🎯 成功标准

### 必须通过 (P0)

- ✅ 前端正常启动和加载
- ✅ Pool列表显示活跃Pool (fee=10000)
- ✅ 价格数据能够查询（即使显示为0）
- ✅ Swap UI正常显示（即使执行失败）

### 应该通过 (P1)

- ⬜ 价格显示合理值($2000-5000/ETH)
- ⬜ TVL显示正确 (~$9)
- ⬜ Tick显示 ~196200
- ⬜ 实时数据刷新

### 期望通过 (P2)

- ⬜ Swap成功执行
- ⬜ 图表/可视化正常
- ⬜ 响应速度快 (<2s)

---

## 📸 测试截图建议

建议在测试过程中截图保存：

1. **首页** - 显示整体布局
2. **Pool列表** - 显示活跃Pool和旧Pool
3. **Pool详情** - 显示Tick、价格、流动性
4. **Swap页面** - 显示输入输出和预估
5. **开发者工具** - Network标签显示RPC调用
6. **错误页面** (如有) - 帮助调试

---

## 🚀 测试完成后

### 提交测试报告

完成测试后，请记录：

1. **通过的测试项数量**
2. **失败的测试项及原因**
3. **发现的Bug列表**
4. **性能问题（如加载慢）**
5. **改进建议**

### 下一步行动

根据测试结果：

- ✅ 如全部通过 → 准备生产部署
- ⚠️ 如部分通过 → 修复P0问题
- ❌ 如大量失败 → 回顾配置，重新测试

---

## 📞 技术支持

**遇到问题**？检查：

1. **前端日志**: `frontend/npm run dev`的输出
2. **浏览器控制台**: F12 → Console标签
3. **Network请求**: F12 → Network标签
4. **配置文件**: 
   - `frontend/lib/contracts.ts`
   - `frontend/hooks/useLiquidity.ts`
   - `frontend/hooks/useSwap.ts`
   - `frontend/hooks/usePoolPrice.ts`

---

**测试手册版本**: v1.0  
**最后更新**: 2026-02-11T13:33:00Z  
**适用于**: ILAL Frontend (Pool fee=10000 update)

